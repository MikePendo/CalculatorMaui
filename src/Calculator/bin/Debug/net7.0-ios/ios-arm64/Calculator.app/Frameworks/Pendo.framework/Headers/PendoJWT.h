//
//  JWT.h
//  PendoSDK
//
//  Created by Noam Bar-Touv on 05/10/2023.
//  Copyright Â© 2023 Pendo.io. All rights reserved.
//

#import <Foundation/Foundation.h>

NS_ASSUME_NONNULL_BEGIN

@interface PendoJWT : NSObject

/**
 * Must be called <b>after</b> the SDK was initialized.
 *
 * @brief start a session with a new visitor. Pass a JWT generated by your server-side and signed using the shared private.
 *  In case a session was already started before, end the previous one and start a new one.
 *  The expected JWT body format: (visitor properties are optional)
 *
 *  Identified visitor:
 *
 *  {
 *    "visitor" : {
 *       "id" : "visitor name",
 *       "visitorProperty1" : "visitorValue1",
 *       "visitorProperty2" : "visitorValue2"
 *    },
 *    "account" : {
 *       "id" : "account name",
 *       "accountProperty1" : "accountValue1",
 *       "accountProperty2" : "accountValue2"
 *    }
 *  }
 *
 *  Anonymous visitor:
 *
 *  {
 *    "visitor" : {
 *       "id" : "",
 *       "visitorProperty1" : "visitorValue1",
 *       "visitorProperty2" : "visitorValue2"
 *    },
 *    "account" : {
 *       "id" : ""
 *    }
 *  }
 *
 * @param jwt The jwt including the session visitor and account data.
 * @param signingKeyName The key name used to sign the jwt.
 */
- (void)startSession:(NSString *)jwt signingKeyName:(NSString *)signingKeyName;

/**
 * Set a visitor data value.
 * This data is used by Pendo Mobile for creating audiences or reporting analytics.
 * For instance you might want to provide data on the visitor's age or if the visitor is logged into a service.
 * The data is accumulated and maintained between sessions.
 * The expected JWT body format:
 *
 *  {
 *    "visitor" : {
 *       "id" : "visitor name",
 *       "visitorProperty1" : "visitorValue1",
 *       "visitorProperty2" : "visitorValue2"
 *    }
 *  }
 *
 * @param jwt The jwt including the session visitor data.
 * @param signingKeyName The key name used to sign the jwt.
 */
- (void)setVisitorData:(NSString *)jwt signingKeyName:(NSString *)signingKeyName;

/**
 * Set account data value for a given data name.
 * This data is used by Pendo Mobile for creating audiences or reporting analytics.
 * For instance you might want to provide data on the account's subscription or if the account is active or not.
 * The data is accumulated and maintained between sessions.
 * The expected JWT body format:
 *
 *  {
 *    "account" : {
 *       "id" : "account name",
 *       "accountProperty1" : "accountValue1",
 *       "accountProperty2" : "accountValue2"
 *    }
 *  }
 *
 * @param jwt The jwt including the session visitor data.
 * @param signingKeyName The key name used to sign the jwt.
 */
- (void)setAccountData:(NSString *)jwt signingKeyName:(NSString *)signingKeyName;
@end

NS_ASSUME_NONNULL_END
